<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" 
				xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" 
				layout:decorate="~{layout}" 
				layout:fragment="content">


<body>
	<main id="main" class="main">
		<!-- 인사카드 등록 모달 -->
		<form th:action="@{/employee_list2}" method="post">
			<div class="modal fade" id="registerModal" tabindex="-1">
				<div class="modal-dialog modal-xl">
					<div class="modal-content">
						<div class="modal-header">
							<h5 class="modal-title">인사카드 등록</h5>
							<button type="button" class="btn-close" data-bs-dismiss="modal"
								aria-label="Close"></button>
						</div>
						<div class="modal-body">
							<!-- General Form Elements -->
							<div class="row mb-3">
								<label for="inputText" class="col-sm-1 col-form-label">아이디</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" id="employee_id" name="employee_id">
								</div>
								<label for="inputEmail" class="col-sm-1 col-form-label">비밀번호</label>
								<div class="col-sm-4">
									<input type="password" class="form-control" id="employee_pw" name="employee_pw">
								</div>
							</div>
							<div class="row mb-3">
								<label for="inputText" class="col-sm-1 col-form-label">부서코드</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" id="employee_dp" name="employee_dp">
								</div>
								<label for="inputEmail" class="col-sm-1 col-form-label">직급코드</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" id="employee_gd" name="employee_gd">
								</div>
							</div>
							<div class="row mb-3">

								<label for="inputDate" class="col-sm-1 col-form-label">입사일</label>
								<div class="col-sm-2">
									<input type="text" class="form-control" id="employee_hd" name="employee_hd"
										aria-label="Date-Time">
								</div>
								<div class="col-sm-2">
									<div id="hd_wrapper"></div>
								</div>
								<label for="inputDate" class="col-sm-1 col-form-label">퇴사일</label>
								<div class="col-sm-2">
									<input type="text" class="form-control" id="employee_rd" name="employee_rd"
										aria-label="Date-Time">
								</div>
								<div class="col-sm-2">
									<div id="rd_wrapper"></div>
								</div>

							</div>
							<div class="row mb-3">
								<label for="inputPassword" class="col-sm-1 col-form-label">퇴사사유</label>
								<div class="col-sm-5">
									<textarea class="form-control" style="height: 100px"
										id="employee_rr" name="employee_rr"></textarea>
								</div>
							</div>
							<div class="row mb-3">
								<label for="inputText" class="col-sm-1 col-form-label">채용구분</label>
								<div class="col-sm-4">
									<select class="form-select" aria-label="Default select example"
										id="employee_cg" name="employee_cg">
										<option value="">신입</option>
										<option value="">경력</option>
									</select>
								</div>
							</div>
							<div class="row mb-3">
								<label for="inputPassword" class="col-sm-1 col-form-label">비고</label>
								<div class="col-sm-5">
									<textarea class="form-control" id="employee_nt" name="employee_nt"
										style="height: 100px"></textarea>
								</div>
							</div>
							<div class="row mb-3">
								<label for="inputText" class="col-sm-1 col-form-label">사원명</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" id="employee_nm" name="employee_nm">
								</div>
								<label for="inputDate" class="col-sm-1 col-form-label">생년월일</label>
								<div class="col-sm-2">
									<input type="text" class="form-control" id="employee_bd" name="employee_bd"
										aria-label="Date-Time">
								</div>
								<div class="col-sm-2">
									<div id="bd_wrapper"></div>
								</div>
							</div>
							<div class="row mb-3">
								<label for="inputText" class="col-sm-1 col-form-label">우편번호</label>
								<div class="col-sm-4">
									<input type="text" class="form-control form-control-user"
										id="employee_zc"  name="zipCode" placeholder="우편번호" readonly
										onclick="findAddr()">
								</div>
							</div>
							<div class="row mb-3">
								<label for="inputText" class="col-sm-1 col-form-label">기본주소</label>
								<div class="col-sm-4">
									<input type="text" class="form-control form-control-user"
										id="employee_sa" name="employee_sa" placeholder="도로명 주소"
										readonly>
								</div>
								<label for="inputEmail" class="col-sm-1 col-form-label">상세주소</label>
								<div class="col-sm-4">
									<input type="text" class="form-control form-control-user"
										id="employee_da" name="employee_da" placeholder="상세 주소">
								</div>
							</div>
							<input type="hidden" id="employee_ad" name="employee_ad">
							<fieldset class="row mb-3">
								<legend class="col-form-label col-sm-1 pt-0">성별</legend>
								<div class="col-sm-10">
									<div class="form-check">
										<input class="form-check-input" type="radio" 
											id="employee_sb1" name="employee_sb1" value="option1" checked> <label
											class="form-check-label" for="gridRadios1"> 남 </label>
									</div>
									<div class="form-check">
										<input class="form-check-input" type="radio" 
											id="employee_sb2" name="employee_sb2" value="option2"> <label
											class="form-check-label" for="gridRadios2"> 여 </label>
									</div>
								</div>
							</fieldset>
							<div class="row mb-3">
							    <label for="inputText" class="col-sm-1 col-form-label">이메일</label>
							    <div class="col-sm-3">
							        <input type="text" class="form-control" id="employee_username" name="employee_username" placeholder="아이디 입력">
							    </div>
							    <div class="col-auto">@</div>
								<div class="col-sm-3">
								    <input class="form-control" id="custom_domain" name="custom_domain" type="text" placeholder="직접 입력" aria-label="직접 도메인 입력">
								</div>
							    <div class="col-sm-3">
									<select class="form-select" id="employee_domain" name="employee_domain" aria-label="도메인 선택">
									    <option value="custom" selected>직접 입력</option>
									    <option value="naver.com">naver.com</option>
									    <option value="google.com">google.com</option>
									    <option value="hanmail.net">hanmail.net</option>
									    <option value="nate.com">nate.com</option>
									    <option value="kakao.com">kakao.com</option>
									</select>
							    </div>
							</div>
							<input type="hidden" id="employee_em" name="employee_em">
							<div class="row mb-3">
								<label for="inputNumber" class="col-sm-1 col-form-label">사진등록</label>
								<div class="col-sm-5">
									<input class="form-control" type="file" id="employee_pi" name="employee_pi">
								</div>
							</div>
							<div class="row mb-3">
								<label for="inputText" class="col-sm-1 col-form-label">기본급</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" id="employee_bs" name="employee_bs">
								</div>
								<label for="inputText" class="col-sm-1 col-form-label">은행</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" id="employee_bk" name="employee_bk">
								</div>
							</div>
							<div class="row mb-3">
								<label for="inputText" class="col-sm-1 col-form-label">계좌번호</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" id="employee_an" name="employee_an">
								</div>
								<label for="inputText" class="col-sm-1 col-form-label">예금주</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" id="employee_dt" name="employee_dt">
								</div>
							</div>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-secondary"
								data-bs-dismiss="modal">닫기</button>
							<button type="submit" class="btn btn-primary">등록</button>
						</div>
					</div>
				</div>
			</div>
		</form>
		<!-- End Extra Large Modal-->
		<div class="pagetitle">
			<h1>Form Elements</h1>
			<nav>
				<ol class="breadcrumb">
					<li class="breadcrumb-item"><a href="index.html">Home</a></li>
					<li class="breadcrumb-item">Forms</li>
					<li class="breadcrumb-item active">Elements</li>
				</ol>
			</nav>
		</div>
		<!-- End Page Title -->
		<section class="section">
			<div class="row">
				<div class="col-lg-12">

					<div class="card">
						<div class="card-body">
							<h5 class="card-title">인사카드 등록</h5>
							<div class="row mb-3">
								<div class="col-sm-10">
									<div id="grid"></div>
									<button type="button" class="btn btn-primary" data-bs-toggle="modal"
									data-bs-target="#registerModal">등록</button>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
	</main>
	<!-- End main -->
</body>


<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script>
    function findAddr(){
        new daum.Postcode({
            oncomplete: function(data) {
            	// 우편번호
                $("#employee_gc").val(data.zonecode);
                // 도로명 및 지번주소
                $("#employee_sa").val(data.roadAddress);
                
                // 상세주소로 포커스 
                $("#employee_da").focus();
				
				// 주소 통합
				let employee_ad = "("+ data.zonecode + ")" + ' ' + data.roadAddress + ' ' + $("#employee_da").val();
				$("#employee_ad").val(employee_ad);
            }
        }).open();
    }

	// 입사일 datepicker
	$(document).ready(function() {
		const datepicker = new tui.DatePicker('#hd_wrapper', {
	        date: new Date(),
	        input: {
	            element: '#employee_hd',
	            format: 'yyyy-MM-dd'
	        }
	    });
	});

	// 퇴사일 datepicker
	$(document).ready(function() {
		const datepicker = new tui.DatePicker('#rd_wrapper', {
	        date: new Date(),
	        input: {
	            element: '#employee_rd',
	            format: 'yyyy-MM-dd'
	        }
	    });
	});

	// 생년월일 datepicker
	$(document).ready(function() {
		const datepicker = new tui.DatePicker('#bd_wrapper', {
	        date: new Date(),
	        input: {
	            element: '#employee_bd',
	            format: 'yyyy-MM-dd'
	        }
	    });
	});
	
	// 이메일 관련 처리
	document.getElementById('employee_domain').addEventListener('change', function() {
	    const customDomainInput = document.getElementById('custom_domain');
	    if (this.value !== "custom") {
	        customDomainInput.value = this.value;
	        customDomainInput.disabled = true;
	    } else {
	        customDomainInput.value = "";
	        customDomainInput.disabled = false;
	        customDomainInput.placeholder = "직접 입력";
	    }
	});
	
	// 이메일 합치기
	function updateFullEmail() {
	    const username = document.getElementById('employee_username').value.trim();
	    const domainSelect = document.getElementById('employee_domain');
	    const customDomainInput = document.getElementById('custom_domain');
	    const fullEmailInput = document.getElementById('employee_em');

	    let domain = domainSelect.value;
	    if (domain === "custom") {
	        domain = customDomainInput.value.trim();
	    }

	    fullEmailInput.value = `${username}@${domain}`;
	}

	document.getElementById('employee_username').addEventListener('input', updateFullEmail);
	document.getElementById('employee_domain').addEventListener('change', updateFullEmail);
	document.getElementById('custom_domain').addEventListener('input', updateFullEmail);
	
</script>

	
<script th:inline="javascript">
    // 서버에서 전달된 데이터를 JavaScript 변수로 설정
    const employeeList = /*[[${employeeList}]]*/ [];
</script>

<script>
	
$(function () {
	    const grid = new tui.Grid({
	        el: document.getElementById('grid'), // 그리드 컨테이너
	        data: employeeList, // 데이터를 설정
	        scrollX: false, // 가로 스크롤 비활성화
	        scrollY: false, // 세로 스크롤 비활성화
	        columns: [
				{
				    header: '사원명',
				    name: 'employee_nm'
				},
				{
				    header: '부서',
				    name: 'employee_dp'
				},
				{
				    header: '직급',
				    name: 'employee_gd'
				},
				{
				    header: '생년월일',
				    name: 'employee_bd'
				},
				{
				    header: '주소',
				    name: 'employee_ad'
				},
				{
				    header: '연락처',
				    name: 'employee_ph'
				},
				{
				    header: '이메일',
				    name: 'employee_em'
				},
				{
				    header: '입사일',
				    name: 'employee_hd'
				}

	        ]
	    });

	    // 반복문으로 데이터를 추가할 경우
	    const newData = [];
	    employeeList.forEach(employee => {
	        newData.push({
	            employee_nm: employee.employee_nm,
	            employee_dp: employee.employee_dp,
	            employee_gd: employee.employee_gd,
	            employee_bd: employee.employee_bd,
	            employee_ad: employee.employee_ad,
	            employee_ph: employee.employee_ph,
	            employee_em: employee.employee_em,
	            employee_hd: employee.employee_hd,
	        });
	    });

	    // 그리드 데이터 갱신
	    grid.resetData(newData);
	});


</script>
</html>