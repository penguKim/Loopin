<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.itwillbs.c4d2412t3p1.mapper.PrimaryMapper">
<!-- //////////////////////////////////////////////////////////// 창고 관리 //////////////////////////////////////////////////////////// -->
	<!-- 창고 조회 -->
	<select id="select_WAREHOUSE_list" resultType="Warehouse">
		WITH WAREAREALIST AS (
			SELECT WAREHOUSE_CD, COUNT(*) WACOUNT
			  FROM WAREAREA 
			 GROUP BY WAREHOUSE_CD
		)
		SELECT WH.WAREHOUSE_CD, WH.WAREHOUSE_NM, CC.COMMON_NM WAREHOUSE_TP, WH.WAREHOUSE_IN, 
			   WH.WAREHOUSE_RM, WH.WAREHOUSE_US, NVL(WA.WACOUNT, 0) WACOUNT
		  FROM WAREHOUSE WH
		  LEFT OUTER JOIN COMMON_CODE CC ON CC.COMMON_GC ='WHTYPE' AND CC.COMMON_CC = WH.WAREHOUSE_TP
		  LEFT OUTER JOIN WAREAREALIST WA ON WA.WAREHOUSE_CD = WH.WAREHOUSE_CD
		 WHERE 1 = 1
		 <if test="filter.warehouse_cd != null and filter.warehouse_cd != ''">AND WH.WAREHOUSE_CD LIKE '%${filter.warehouse_cd}%'</if>
		 <if test="filter.warehouse_nm != null and filter.warehouse_nm != ''">AND WH.WAREHOUSE_NM LIKE '%${filter.warehouse_nm}%'</if>
		 <if test="filter.warehouse_tp != null and filter.warehouse_tp != ''">AND WH.WAREHOUSE_TP = #{filter.warehouse_tp}</if>
		 <if test="filter.warehouse_us != null and filter.warehouse_us != 'ALL'">AND WH.WAREHOUSE_US = #{filter.warehouse_us}</if>
		 ORDER BY WH.WAREHOUSE_IN
	</select>
<!-- //////////////////////////////////////////////////////////// 제품 관리 //////////////////////////////////////////////////////////// -->
	<!-- 제품 조회 -->
	<select id="select_PRODUCT_list" resultType="Product">
		SELECT PR.*
		  FROM PRODUCT PR
		  <!--
		  LEFT OUTER JOIN COMMON_CODE CC ON CC.COMMON_GC ='WHTYPE' AND CC.COMMON_CC = WH.WAREHOUSE_TP
		 WHERE 1 = 1
		 <if test="filter.warehouse_cd != null and filter.warehouse_cd != ''">AND WH.WAREHOUSE_CD LIKE '%${filter.warehouse_cd}%'</if>
		 <if test="filter.warehouse_nm != null and filter.warehouse_nm != ''">AND WH.WAREHOUSE_NM LIKE '%${filter.warehouse_nm}%'</if>
		 <if test="filter.warehouse_tp != null and filter.warehouse_tp != ''">AND WH.WAREHOUSE_TP = #{filter.warehouse_tp}</if>
		 <if test="filter.warehouse_us != null and filter.warehouse_us != 'ALL'">AND WH.WAREHOUSE_US = #{filter.warehouse_us}</if>
		 ORDER BY WH.WAREHOUSE_IN
		 -->
	</select>
	<!-- 창고 목록 조회 -->
	<resultMap id="warehouseMap" type="map">
	    <result column="WAREHOUSE_CD" property="common_cc"/>
	    <result column="WAREHOUSE_NM" property="common_nm"/>
	</resultMap>
	<select id="select_WAREHOUSE_code" resultMap="warehouseMap">
	    SELECT WAREHOUSE_CD, WAREHOUSE_NM
	    FROM WAREHOUSE
	    WHERE WAREHOUSE_US = 1
	</select>

	

</mapper>
